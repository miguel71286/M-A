{"ast":null,"code":"import _objectSpread from\"/Users/miguelangelmanzano/Desktop/CODES M-A/React-Mongo/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/miguelangelmanzano/Desktop/CODES M-A/React-Mongo/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/miguelangelmanzano/Desktop/CODES M-A/React-Mongo/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/miguelangelmanzano/Desktop/CODES M-A/React-Mongo/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{useForm}from'react-hook-form';import'./Auth.css';import Card from'../components/Card';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Auth(props){var gestionarAcceso=props.gestionarAcceso;// función que usamos para pasar los datos del servidor a la App principal\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),tieneAcceso=_useState2[0],setTieneAcceso=_useState2[1];// variable de estado que indica si el usuario existe o no en la base de datos.\nvar _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,setValue=_useForm.setValue,errors=_useForm.formState.errors;// hook del formulario para 'react-hook-form'\nvar gestorDeCambioDeModo=function gestorDeCambioDeModo(){if(!tieneAcceso){setValue('Nombre',undefined);}setTieneAcceso(!tieneAcceso);};var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// Envío de los datos del formulario ( data ) al servidor\nconsole.log(data);if(tieneAcceso){_context.next=6;break;}_context.next=4;return axios.post(process.env.REACT_APP_BACKEND_URL+'/usuarios/alta',{// endpoint de la API de nuestro servidor\nnombre:data.nombre,// dato extraído del formulario\nemail:data.email,// dato extraído del formulario\npassword:data.password// dato extraído del formulario\n}).then(function(response){console.log('Usuario creado');// Si se recibe este mensaje en consola es que se ha dado de alta correctamente\ngestionarAcceso(response.data);// enviamos a la App la respuesta del servidor, que contiene el token creado por este, el e-mail y el password del usuario.\n}).catch(function(error){console.log(error.response.data);});case 4:_context.next=8;break;case 6:_context.next=8;return axios.post(process.env.REACT_APP_BACKEND_URL+'/usuarios/login',{email:data.email,password:data.password}).then(function(response){console.log('Login Correcto');gestionarAcceso(response.data);// enviamos a la App la respuesta del servidor, que contiene el token creado por este\n}).catch(function(error){console.log(error);});case 8:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Card,{className:\"authentication\",children:[/*#__PURE__*/_jsx(\"h2\",{children:tieneAcceso?'Login necesario':'Introduzca datos de alta'}),/*#__PURE__*/_jsxs(\"form\",{className:\"card\",onSubmit:handleSubmit(onSubmit),children:[!tieneAcceso&&/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"text\",placeholder:\"Nombre de Usuario.\"},register('nombre',{required:true,message:'Requerido'}))),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"text\",placeholder:\"Email\"},register('email',{required:true,pattern:/^\\S+@\\S+$/i}))),errors.email&&errors.email.type==='required'&&/*#__PURE__*/_jsx(\"span\",{children:\"Se requiere e-mail v\\xE1lido\"}),errors.email&&errors.email.type==='pattern'&&/*#__PURE__*/_jsx(\"span\",{children:\"Se requiere e-mail v\\xE1lido\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"password\",placeholder:\"Contrase\\xF1a\"},register('password',{required:true,minLength:6}))),errors.password&&errors.password.type==='required'&&/*#__PURE__*/_jsx(\"span\",{children:\"Se requiere contrase\\xF1a\"}),errors.password&&errors.password.type==='minLength'&&/*#__PURE__*/_jsx(\"span\",{children:\"M\\xEDnimo de 6 caracteres\"}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-form\",type:\"submit\",children:[tieneAcceso?'ACCESO':'ALTA',\" \"]})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-cambia\",onClick:gestorDeCambioDeModo,children:[\"CAMBIAR A \",tieneAcceso?'ALTA':'ACCESO']})]})});}","map":{"version":3,"sources":["/Users/miguelangelmanzano/Desktop/CODES M-A/React-Mongo/Frontend/src/pages/Auth.js"],"names":["React","useState","useForm","Card","axios","Auth","props","gestionarAcceso","tieneAcceso","setTieneAcceso","register","handleSubmit","setValue","errors","formState","gestorDeCambioDeModo","undefined","onSubmit","data","console","log","post","process","env","REACT_APP_BACKEND_URL","nombre","email","password","then","response","catch","error","required","message","pattern","type","minLength"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport { useForm } from 'react-hook-form';\r\nimport './Auth.css';\r\nimport Card from '../components/Card';\r\nimport axios from 'axios';\r\n\r\nexport default function Auth(props) {\r\n\tconst { gestionarAcceso } = props; // función que usamos para pasar los datos del servidor a la App principal\r\n\tconst [tieneAcceso, setTieneAcceso] = useState(false); // variable de estado que indica si el usuario existe o no en la base de datos.\r\n\r\n\tconst {\r\n\t\tregister,\r\n\t\thandleSubmit,\r\n\t\tsetValue,\r\n\t\tformState: { errors },\r\n\t} = useForm(); // hook del formulario para 'react-hook-form'\r\n\r\n\tconst gestorDeCambioDeModo = () => { \r\n\t\tif (!tieneAcceso) {\r\n\t\t\tsetValue('Nombre', undefined);\r\n\t\t}\r\n\t\tsetTieneAcceso(!tieneAcceso);\r\n\t};\r\n\r\n\tconst onSubmit = async (data) => {\r\n\t\t// Envío de los datos del formulario ( data ) al servidor\r\n\t\tconsole.log(data);\r\n\t\tif (!tieneAcceso) {\r\n\t\t\tawait axios\r\n\t\t\t\t.post(process.env.REACT_APP_BACKEND_URL + '/usuarios/alta', {\r\n\t\t\t\t\t// endpoint de la API de nuestro servidor\r\n\t\t\t\t\tnombre: data.nombre, // dato extraído del formulario\r\n\t\t\t\t\temail: data.email, // dato extraído del formulario\r\n\t\t\t\t\tpassword: data.password, // dato extraído del formulario\r\n\t\t\t\t})\r\n\t\t\t\t.then((response) => {\r\n\t\t\t\t\tconsole.log('Usuario creado'); // Si se recibe este mensaje en consola es que se ha dado de alta correctamente\r\n\t\t\t\t\tgestionarAcceso(response.data); // enviamos a la App la respuesta del servidor, que contiene el token creado por este, el e-mail y el password del usuario.\r\n\t\t\t\t})\r\n\t\t\t\t.catch((error) => {\r\n\t\t\t\t\tconsole.log(error.response.data);\r\n\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tawait axios\r\n\t\t\t\t.post(process.env.REACT_APP_BACKEND_URL +'/usuarios/login', {\r\n\t\t\t\t\temail: data.email,\r\n\t\t\t\t\tpassword: data.password,\r\n\t\t\t\t})\r\n\t\t\t\t.then((response) => {\r\n\t\t\t\t\tconsole.log('Login Correcto');\r\n\t\t\t\t\tgestionarAcceso(response.data); // enviamos a la App la respuesta del servidor, que contiene el token creado por este\r\n\t\t\t\t})\r\n\t\t\t\t.catch((error) => {\r\n\t\t\t\t\tconsole.log(error);\r\n\t\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t<Card className='authentication'>\r\n\t\t\t<h2>{tieneAcceso ? 'Login necesario' : 'Introduzca datos de alta'}</h2>\r\n\t\t\t<form className='card' onSubmit={handleSubmit(onSubmit)}>\r\n\t\t\t\t{!tieneAcceso && (\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype='text'\r\n\t\t\t\t\t\tplaceholder='Nombre de Usuario.'\r\n\t\t\t\t\t\t{...register('nombre', { required: true, message: 'Requerido' })}\r\n\t\t\t\t\t/>\r\n\t\t\t\t)}\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype='text'\r\n\t\t\t\t\tplaceholder='Email'\r\n\t\t\t\t\t{...register('email', { required: true, pattern: /^\\S+@\\S+$/i })}\r\n\t\t\t\t/>\r\n\t\t\t\t{errors.email && errors.email.type === 'required' && (\r\n\t\t\t\t\t<span>Se requiere e-mail válido</span>\r\n\t\t\t\t)}\r\n\t\t\t\t{errors.email && errors.email.type === 'pattern' && (\r\n\t\t\t\t\t<span>Se requiere e-mail válido</span>\r\n\t\t\t\t)}\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype='password'\r\n\t\t\t\t\tplaceholder='Contraseña'\r\n\t\t\t\t\t{...register('password', { required: true, minLength: 6 })}\r\n\t\t\t\t/>\r\n\t\t\t\t{errors.password && errors.password.type === 'required' && (\r\n\t\t\t\t\t<span>Se requiere contraseña</span>\r\n\t\t\t\t)}\r\n\t\t\t\t{errors.password && errors.password.type === 'minLength' && (\r\n\t\t\t\t\t<span>Mínimo de 6 caracteres</span>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<button className=\"btn-form\" type='submit'>{tieneAcceso ? 'ACCESO' : 'ALTA'} </button>\r\n\t\t\t</form>\r\n\t\t\t<button className=\"btn-cambia\" onClick={gestorDeCambioDeModo}>\r\n\t\t\t\tCAMBIAR A {tieneAcceso ? 'ALTA' : 'ACCESO'}\r\n\t\t\t</button>\r\n\t\t</Card>\r\n\t\t</div>\r\n\t);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}